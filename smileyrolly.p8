pico-8 cartridge // http://www.pico-8.com
version 34
__lua__
local player = {}
player.x = 0
player.y = 67
player.sprite = 0
player.speed = 2
player.moving = false
player.jumping = false
player.jumpingup = false

local badguy = {}
badguy.x = 64;
badguy.y = 67;
badguy.sprite = 9;
badguy.speed = 2;

local gameover = false;

function moveanim()
    player.moving = true
    player.sprite += 1
    if player.sprite > 3 then
        player.sprite = 0
    end
end

function drawgameover()
    spr(13, 30, 45)
    spr(14, 38, 45)
    spr(15, 46, 45)
    spr(16, 54, 45)
    spr(17, 62, 45)
    spr(18, 70, 45)
    spr(19, 78, 45)
    spr(20, 86, 45)
    spr(21, 94, 45)
end

function _draw()
    cls() -- clear screen
    map(0,0,0,20,124,124) -- draw background
    spr(player.sprite, player.x, player.y) -- draw sprite
    spr(badguy.sprite, badguy.x, badguy.y)

    if gameover then
        drawgameover() -- draw gameover screen
    end
end

function _update()
    player.moving = false

    if (btn(0)) then
        player.x -= player.speed -- move left
        if player.x < -10 then
            player.x = 128 -- wrap screen
        end
        moveanim()
    end

    if (btn(1)) then
        player.x += player.speed -- move right
        if player.x > 128 then
            player.x = -10 -- wrap screen
        end
        moveanim()
    end

    if (btn(2)) then
        player.jumping = true -- enter jump sequence
        player.jumpingup = true
    end

    if player.jumping then
        if player.jumpingup then -- on his way up
            player.y -= 2
        else
            player.y += 2 -- on his way down
        end
        if player.y < 59 then
            player.jumpingup = false -- reached the top, head back down
        end
        if player.y > 65 then
            player.jumping = false -- we've reached the ground
        end
    end

    badguy.sprite += 1
    if badguy.sprite > 11 then
    	badguy.sprite = 9 -- loop through animation
    end

    badguy.x += badguy.speed -- continually loop around screen
    if badguy.x > 128 then
       badguy.x = -10
    end

    if player.x == badguy.x and player.y == badguy.y then
        gameover = true -- TODO: better collision detection
    end
end
__gfx__
00aaaa0000aaaa0000aaaa0000aaaa00bbbbbbbbccccccccccaaaacccccccccccccccccc00000000000000000000000000000000000000000000000000000000
0aaaaaa00aaaaaa00aaaaaa00aaaaaa0bbbbbbbbcccccccccaaaaaaccccccccccccccccc088888800888888008888880088888800999999000bbbb0000800800
aa0aa0aaaa0a0aaaaaa00aaaaaa0a0aabbbbbbbbccccccccaaaaaaaaccc7cccccccccccc08088080088080800880088008808080090000000bb00bb000808800
aaaaaaaaaaaaa0aaaa0aa0aaaa0aaaaabbbbbbbbccccccccaaaaaaaacc777ccccccccccc08888880080888800808808008088880090000000b0000b008080080
aa0aa0aaaaaaa0aaaaaaaaaaaa0aaaaabbbbbbbbccccccccaaaaaaaac77777cccccccccc08088080080888800888888008088880090009900bbbbbb008080080
aaa00aaaaa0a0aaaaa0aa0aaaaa0a0aabbbbbbbbccccccccaaaaaaaac77777cccccccccc08800880088080800808808008808080090000900b0000b008000080
0aaaaaa00aaaaaa00aaaaaa00aaaaaa0bbbbbbbbcccccccccaaaaaaccccccccccccccccc08888880088888800888888008888880099999900b0000b008000080
00aaaa0000aaaa0000aaaa0000aaaa00bbbbbbbbccccccccccaaaacccccccccccccccccc00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0dddddd000000000001111000e0000e00aaaaaa00333330000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d00000000000000010000100e0000e00a0000000300003000000000000000000000000000000000000000000000000000000000000000000000000000000000
0dddd000000000000100001000e00e000aaaa0000300003000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d000000000000000100001000e00e000a0000000333330000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d000000000000000100001000e0e0000a0000000303000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0dddddd00000000000111100000e00000aaaaaa00300333000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506050507050507050505050705050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0507050508080505050505050505070500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505070808070808080708080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505070505050505050507050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080807080808080808070800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080808080808080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
